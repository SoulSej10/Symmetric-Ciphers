{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symmetric Ciphers</title>
    <link rel="stylesheet" href="{% static 'styles/caesar_cipher.css' %}">
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                </svg>
                <span>CipherLab</span>
            </div>
            <nav>
                <a href="#">Home</a>
                <a href="#">The Team</a>
                <button aria-label="User menu">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    </svg>
                </button>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="dual-container">
                <div class="card card-left">
                    <div class="card-header">
                        <h1 class="card-title">Symmetric Ciphers</h1>
                        <p class="card-description">Encryption and Decryption</p>
                    </div>
                    {% if error %}
                    <div class="error-message">
                        <p>{{ error }}</p>
                    </div>
                    {% endif %}

                    <form method="POST">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="cipher">Select Cipher</label>
                            <select id="cipher" name="cipher" onchange="autoUpdate()">
                                <option value="caesar" {% if cipher == "caesar" %}selected{% endif %}>Caesar Cipher</option>
                                <option value="vigenere" {% if cipher == "vigenere" %}selected{% endif %}>Vigen√®re Cipher</option>
                                <option value="playfair" {% if cipher == "playfair" %}selected{% endif %}>Playfair Cipher</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="text">Text</label>
                            <textarea id="text" name="text" rows="4" required>{{ text|default:"" }}</textarea>
                        </div>

                        <div class="form-group">
                            <label for="shift">Key</label>
                            <input id="shift" name="shift" type="text" value="{{ shift|default:"" }}" required>
                        </div>

                        <div class="button-group">
                            <button type="submit" name="operation" value="encrypt">Encrypt</button>
                            <button type="submit" name="operation" value="decrypt">Decrypt</button>
                        </div>
                    </form>

                    {% if result %}
                        <div class="result-box">
                            <h3>Result</h3>
                            <p>{{ result }}</p>
                        </div>
                    {% endif %}
                </div>

                <div class="card card-right">
                    <div class="card-header">
                        <h1 class="card-title">Opposite Operation</h1>
                        <p class="card-description">The result of the opposite operation</p>
                    </div>
                
                    <div class="operation-label">
                        <h3 id="opposite-operation-label">{{ opposite_operation_label }}</h3>
                        <p id="data-label">{{ data_label }}</p>
                    </div>
                
                    <div class="result-box">
                        <h3>Result</h3>
                        <p id="opposite-result">{{ opposite_result }}</p>
                    </div>
                
                    <!-- Add the Caesar Cipher explanation -->
                    <div class="cipher-explanation">
                        <h3>How Caesar Cipher Works</h3>
                        <p>{{ caesar_explanation }}</p>
                    </div>
                </div>
                
                
                

            </div>
        </div>
    </main>

    <script>
        function autoUpdate() {
            const cipher = document.getElementById('cipher').value;
            const operation = document.querySelector('button[type="submit"][name="operation"]').value;

            fetch('/update_opposite_result/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({ cipher, operation })
            })
            .then(response => response.json())
            .then(data => {
                // Update labels
                document.getElementById('opposite-operation-label').textContent = data.opposite_operation_label;
                document.getElementById('data-label').textContent = data.data_label;

                // Update result
                document.getElementById('opposite-result').textContent = data.result;
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }

    </script>
</body>
</html>
